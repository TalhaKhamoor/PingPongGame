<!DOCTYPE html>
<html>
  <head>
    <title>Ping Pong Game</title>
    <style>
      body,
      html {
        width: 100%;
        height: 100%;
        margin: 0;
        overflow: hidden;
        display: block;
        background-color: black;
      }
    </style>
  </head>
  <body>
    <canvas
      id="canvas"
      width="800"
      height="400"
      style="
        background-color: black;
        border: 12px dashed white;
        padding-left: 0;
        padding-right: 0;
        margin-left: auto;
        margin-right: auto;
        display: block;
        width: 98%;
      "
    ></canvas>
    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript">
      //Sample functions, remove these functions and design ping-pong game with onInit and onUpdate.

      let p1DownKeyPressed = false;
      let p1UpKeyPressed = false;
      let p2DownKeyPressed = false;
      let p2UpKeyPressed = false;

      document.addEventListener("keydown", handleKeyDownEvent);
      document.addEventListener("keyup", handleKeyUpEvent);

      app.onInit = function () {
        this.canvas = document.getElementById("canvas");
        this.context = this.canvas.getContext("2d");

        this.nodes.push({
          id: "player-one",
          x: canvas.width + canvas.width * 0.01 - canvas.width,
          y: (canvas.height - canvas.height * 0.2) / 2,
          width: canvas.width * 0.01,
          height: canvas.height * 0.2,
          color: "white",
        });

        this.nodes.push({
          id: "player-two",
          x: canvas.width - canvas.width * 0.02,
          y: (canvas.height - canvas.height * 0.2) / 2,
          width: canvas.width * 0.01,
          height: canvas.height * 0.2,
          color: "white",
        });

        this.nodes.push({
          id: "ball",
          x: (canvas.width - this.getNode("player-one").width * 1) / 2,
          y: (canvas.height - this.getNode("player-one").width * 1) / 2,
          width: this.getNode("player-one").width * 1,
          height: this.getNode("player-one").width * 1,
          color: "white",
          direction: 0,
        });

        this.nodes.push({
          id: "line",
          x: (canvas.width - this.getNode("player-one").width * 1) / 2,
          y: 0,
          width: 7,
          height: canvas.height,
          color: "white",
        });
      };

      app.onUpdate = function (time) {
        // this.getNode("player-one").y++;
        if (p1DownKeyPressed) {
          this.getNode("player-one").y += 5;
          p1DownKeyPressed = false;
        } else if (p1UpKeyPressed) {
          this.getNode("player-one").y -= 5;
          p1UpKeyPressed = false;
        }

        if (Math.cos(this.timestamp / 100) > 0) {
          this.getNode("ball").direction = -1;
        } else {
          this.getNode("ball").direction = 1;
        }

        this.getNode("ball").x += this.getNode("ball").direction;
      };

      function handleKeyDownEvent(keyDown) {
        switch (keyDown.keyCode) {
          case 87:
            p1UpKeyPressed = true;
            break;
          case 83:
            p2DownKeyPressed = true;
            break;
          case 38:
            p2UpKeyPressed = true;
            break;
          case 40:
            p2DownKeyPressed = true;
            break;
        }
        // p1DownKeyPressed = keyDown.keyCode == 83 ? true : false;
      }

      function handleKeyUpEvent(keyUp) {
        // p1UpKeyPressed = keyUp.keyCode == 87 ? true : false;
      }
    </script>
  </body>
</html>
